---
layout: post
title: ç¬¬ä¸€æ¬¡å®éªŒé¡¹ç›®
subtitle: çˆ¬è™«
date: 2020-4-26
author: yanghong
header-img: images/cover/8.jpg
tags: web 
---

æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯too young too simple, sometimes naiveï¼Œ è¿˜è¦æå‡çŸ¥è¯†æ°´å¹³ï¼Œåªèƒ½æŠ„è€å¸ˆä»£ç ã€‚æ„Ÿè§‰è¿™æ¬¡å®éªŒï¼Œè‡ªå·±å†™çš„ä»£ç å’Œè€å¸ˆå†™çš„ä»£ç åªæœ‰ä¸‰ä¸ƒå¼€å§ã€‚ä½†æ˜¯ä¹Ÿä¸èƒ½è¿‡äºç¥è¯è€å¸ˆçš„ä»£ç ï¼Œè¦è¾¨è¯çš„çœ‹å¾…ã€‚æ—©æœŸç¡®å®ä¾èµ–è€å¸ˆçš„ä»£ç æ¥å†™çˆ¬è™«ï¼Œä½†æ˜¯æœ€ç»ˆè¿˜æ˜¯è¦å°½é‡ç”¨è‡ªå·±çš„ä»£ç çš„ã€‚

# æ ¸å¿ƒéœ€æ±‚

1. é€‰å–3-5ä¸ªä»£è¡¨æ€§çš„æ–°é—»ç½‘ç«™ï¼ˆæ¯”å¦‚æ–°æµªæ–°é—»ã€ç½‘æ˜“æ–°é—»ç­‰ï¼Œæˆ–è€…æŸä¸ªå‚ç›´é¢†åŸŸæƒå¨æ€§çš„ç½‘ç«™æ¯”å¦‚ç»æµé¢†åŸŸçš„é›ªçƒè´¢ç»ã€ä¸œæ–¹è´¢å¯Œç­‰ï¼Œæˆ–è€…ä½“è‚²é¢†åŸŸçš„è…¾è®¯ä½“è‚²ã€è™æ‰‘ä½“è‚²ç­‰ç­‰ï¼‰å»ºç«‹çˆ¬è™«ï¼Œé’ˆå¯¹ä¸åŒç½‘ç«™çš„æ–°é—»é¡µé¢è¿›è¡Œåˆ†æï¼Œçˆ¬å–å‡ºç¼–ç ã€æ ‡é¢˜ã€ä½œè€…ã€æ—¶é—´ã€å…³é”®è¯ã€æ‘˜è¦ã€å†…å®¹ã€æ¥æºç­‰ç»“æ„åŒ–ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚
2. å»ºç«‹ç½‘ç«™æä¾›å¯¹çˆ¬å–å†…å®¹çš„åˆ†é¡¹å…¨æ–‡æœç´¢ï¼Œç»™å‡ºæ‰€æŸ¥å…³é”®è¯çš„æ—¶é—´çƒ­åº¦åˆ†æã€‚

æŠ€æœ¯è¦æ±‚ï¼š

1. å¿…é¡»é‡‡ç”¨Node.JSå®ç°ç½‘ç»œçˆ¬è™«

2. å¿…é¡»é‡‡ç”¨Node.JSå®ç°æŸ¥è¯¢ç½‘ç«™åç«¯ï¼ŒHTML+JSå®ç°å‰ç«¯ï¼ˆå°½é‡ä¸è¦ä½¿ç”¨ä»»ä½•å‰åç«¯æ¡†æ¶ï¼‰

 ä»£ç ä»“åº“: https://github.com/ya-hong/crawler

# å¼€å‘è¿‡ç¨‹

~~å…¶å®ä¸»è¦è¿˜æ˜¯æŠ„ä»£ç ~~

åˆ—ä¸€ä¸‹é‡åˆ°çš„å‘æˆ–è€…æ„Ÿè§‰é‡è¦çš„éƒ¨åˆ†ã€‚

## js çš„å¼‚æ­¥ç‰¹æ€§

jsä»£ç ä¸æ˜¯é¡ºåºæ‰§è¡Œçš„ç®—æ˜¯æˆ‘é‡åˆ°çš„ç¬¬ä¸€ä¸ªå‘äº†ã€‚ä¹‹å‰åªä¼šå†™c++ï¼Œæ„Ÿè§‰ç¨‹åºé¡ºåºæ‰§è¡Œæ˜¯å¤©ç»åœ°ä¹‰çš„äº‹æƒ…ã€‚è°ƒè¯•çš„æ—¶å€™æˆ‘å‘ç°æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œæ€ä¹ˆç¨‹åºè¾“å‡ºé¡ºåºæ˜¯åç€çš„ğŸ¤®ã€‚

ç„¶åæˆ‘äº†è§£äº†ä¸€ä¸‹å¼‚æ­¥æœºåˆ¶ï¼šhttps://blog.csdn.net/qq_22855325/article/details/72958345

>  å¼‚æ­¥è¿è¡Œæœºåˆ¶å¤§è‡´å¦‚ä¸‹
>
>  1. æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆ
>  2. ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª"ä»»åŠ¡é˜Ÿåˆ—"ã€‚åªè¦å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æœï¼Œå°±åœ¨"ä»»åŠ¡é˜Ÿåˆ—"ä¹‹ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶
>  3. ä¸€æ—¦"æ‰§è¡Œæ ˆ"ä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–"ä»»åŠ¡é˜Ÿåˆ—"ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›äº‹ä»¶ã€‚é‚£äº›å¯¹åº”çš„å¼‚æ­¥ä»»åŠ¡ï¼Œäºæ˜¯ç»“æŸç­‰å¾…çŠ¶æ€ï¼Œè¿›å…¥æ‰§è¡Œæ ˆï¼Œå¼€å§‹æ‰§è¡Œã€‚
>  4. ä¸»çº¿ç¨‹ä¸æ–­é‡å¤ä¸Šé¢çš„ç¬¬ä¸‰æ­¥ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```javascript
console.log("start");
for (i = 1; i <= 10; ++i) {
    setTimeout(function() {
        console.log("sleep " + i);
    }, 1000);
}
setTimeout(function(){
    console.log("sleep1000");
},1000);
console.log("end");

```

è¾“å‡ºï¼š

```
start
end
(è¿™é‡Œ-1s)
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep 11
sleep1000
```

æˆ‘çš„ç†è§£æ˜¯ï¼Œå…ˆæ‰§è¡Œäº†`console.log("start")`ã€‚ç„¶åæ‰§è¡Œåæ¬¡`setTimeout`å‡½æ•°ï¼ŒæŠŠ`callback`ä¸¢è¿›é˜Ÿåˆ—å¹¶å¼€å§‹è®¡æ—¶ã€‚å†æ‰§è¡Œä¸€æ¬¡`setTimeout`å‡½æ•°ï¼ŒæŠŠ`callback`ä¸¢è¿›é˜Ÿåˆ—å¹¶å¼€å§‹è®¡æ—¶ã€‚æ‰§è¡Œ`console.log("end")`ã€‚ç„¶åç­‰å¾…1sæ‰€æœ‰è®¡æ—¶å…¨éƒ¨ç»“æŸï¼Œä¸”æ­¤æ—¶i=11, æ‰§è¡Œæ‰€æœ‰çš„`console.log`å‡½æ•°ã€‚æ•´ä¸ªè¿‡ç¨‹ç”¨æ—¶å¤§æ¦‚1sã€‚

è¿™é‡Œå°±ä½“ç°äº†javascriptçš„ä¼˜åŠ¿ï¼Œè™½ç„¶ä»–åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä»£ç ï¼Œä½†æ˜¯å®ƒè¿˜æœ‰å…¶ä»–çº¿ç¨‹æ¥æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç”¨å¼‚æ­¥çš„æ–¹å¼å¯ä»¥åœ¨è¿›è¡Œè€—æ—¶ä»»åŠ¡æ—¶æ‰§è¡Œå…¶ä»–ä»£ç ã€‚å¦‚æœè¿™æ®µä»£ç ç”¨c++å†™å°±è‚¯å®šè¦ç­‰ä¸Š11säº†ã€‚

## å›è°ƒå‡½æ•°

JSçš„å‡½æ•°è²Œä¼¼å’Œå…¶ä»–æ•°æ®ç±»å‹æ²¡æœ‰åŒºåˆ«ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€‚ç”¨å›è°ƒå‡½æ•°çš„æ–¹å¼å¯ä»¥ä½¿éƒ¨åˆ†çš„å¼‚æ­¥å‡½æ•°æŒ‰é¡ºåºæ‰§è¡Œã€‚ 

## eval() å‡½æ•°

ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å‡½æ•°ï¼Œ`eval(s)` å¯ä»¥æŠŠså½“ä½œä»£ç æ‰§è¡Œã€‚è™½ç„¶å®ƒå¥½åƒæœ‰æ•ˆç‡ä½ï¼Œä¸å®‰å…¨çš„ç¼ºç‚¹ï¼Œä½†æ˜¯åœ¨çˆ¬è™«å®éªŒé‡Œæˆ‘è§‰å¾—è¿™ä¸ªå‡½æ•°ä½¿å°è£…ä»£ç å˜å¾—å¾ˆæ–¹ä¾¿ã€‚

## request çš„ä½¿ç”¨

ç”¨æ¥æ‹¿åˆ°ç½‘é¡µæºç ã€‚

## cheerio çš„ä½¿ç”¨

ç”¨cheerioåŠ è½½ç½‘ç«™ç§å­é¡µé¢ï¼Œå¯ä»¥æ–¹ä¾¿çš„æœç´¢å‡ºæ–°é—»é“¾æ¥ã€‚åŠ è½½æ–°é—»é¡µé¢ä¹Ÿå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æŸ¥æ‰¾å…¶ä¸­çš„å„ç§å…ƒç´ ã€‚

ä¸€äº›ç”¨æ³•ï¼š

+   åŠ è½½ç½‘é¡µ

    ```javascript
    var $ = myCheerio.load(html, { decodeEntities: true });
    ```

+   æŸ¥æ‰¾æ ‡ç­¾ï¼ˆä¾‹å¦‚metaæ ‡ç­¾ï¼‰

    ```javascript
    $('meta');
    ```

+   æŸ¥æ‰¾æŸä¸ªå±æ€§çš„æ ‡ç­¾

    ```javascript
    $('meta[name="keyword"]');
    ```

+   æŸ¥æ‰¾æ ‡ç­¾ä¸‹çš„æ ‡ç­¾ï¼ˆä¾‹å¦‚divæ ‡ç­¾ä¸‹çš„aæ ‡ç­¾ï¼‰

    ```javascript
    $('div a');
    ```

    æŸ¥æ‰¾divä¸‹ä¸ºaçš„å­æ ‡ç­¾

    ```javascript
    $('div>a');
    ```

+   æŸ¥æ‰¾æŸå±æ€§å€¼ï¼ˆä¾‹å¦‚nameå±æ€§ä¸ºkeywordsçš„metaæ ‡ç­¾çš„contentå±æ€§çš„å±æ€§å€¼ï¼‰

    ```javascript
    $('meta[name="keywords"]').eq(0).attr("content");
    ```

+   æ•´åˆæ–‡æœ¬ä¿¡æ¯

    ```javascript
    $('div[class="article"]').text();
    ```



## mysql æ•°æ®åº“çš„ä½¿ç”¨

å…¶å®æˆ‘ç¬¬ä¸€å¤©å°±çˆ¬äº†ä¸€äº›æ•°æ®äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆæœç´¢ã€‚æŸ¥åˆ°elasticsearchå¯ä»¥å®ç°æœç´¢ä½†æ˜¯ä¸€ç›´æ²¡ææ˜ç™½æ€ä¹ˆç”¨ï¼Œå°±ä¸€ç›´æç½®äº†ã€‚

æœ¬æ¥æˆ‘æ˜¯æŒ‰ç…§æ ‡é¢˜å­˜æˆä¸€ä¸ªä¸ªæ–‡ä»¶çš„ï¼ˆhttps://github.com/ya-hong/crawler/blob/master/del/baidunews.jsï¼‰ï¼Œä½†æ˜¯æŠŠæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“é‡Œæœ‰å¾ˆå¤šå¥½å¤„ã€‚æ˜¯ç›´æ¥è§£å†³äº†æœç´¢çš„é—®é¢˜ï¼Œè€Œä¸”æ˜¯æŸ¥è¯¢ç¼–ç ã€æ ‡é¢˜ã€ä½œè€…ã€æ—¶é—´ã€å…³é”®è¯ã€æ‘˜è¦ã€å†…å®¹ã€æ¥æºç­‰ä¿¡æ¯æ¯”åœ¨æ–‡ä»¶ä¸­é‡æ–°æŸ¥æ‰¾è¦æ–¹ä¾¿ä¸”é«˜æ•ˆã€‚

åœ¨ä»£ç ä¸­è¿æ¥æ•°æ®åº“è¦ç”¨åˆ°mysqlåŒ…ã€‚ä¸»è¦ç”¨åˆ°çš„å‡½æ•°ï¼š

```javascript
var pool = mysql.createPool({
    host: '127.0.0.1',
    user: '',
    password: '',
    database: ''
});
pool.getConnection(function(err, conn) {//è¿æ¥
    if (err) {
        //é”™è¯¯å¤„ç†
    }
    else {
    	conn.query(sql, sqlparam,function(qerr, vals, fields) {//sql ä¸ºæ•°æ®åº“å‘½ä»¤,sqlparamä¸ºå‚æ•°
        	conn.release();
        });
    }
}
```

ä»£ç ï¼šhttps://github.com/ya-hong/crawler/blob/master/mysql.js

## æ­£åˆ™è¡¨è¾¾å¼

åœ¨ç§å­é¡µé¢ä¸Šç”¨cheerioæ‰¾åˆ°çš„é“¾æ¥å¯èƒ½ä¼šåŒ…å«éæ–°é—»é¡µé¢çš„é“¾æ¥ã€‚å¦‚æœèƒ½æ‰¾åˆ°æ–°é—»é¡µé¢å’Œéæ–°é—»é¡µé¢é“¾æ¥çš„åŒºåˆ«ï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†å®ƒä»¬åŒºåˆ†å¼€æ¥ã€‚

ä¸€å¼€å§‹çœ‹åˆ°æœ‰ç‚¹å¤´å¤§ï¼Œä½†æ˜¯å®é™…ä¸Šç½‘é¡µé“¾æ¥ä¸­åªæœ‰å­—æ¯ã€æ•°å­—ã€å†’å·å’Œæ–œæ ã€‚è¿ç©ºæ ¼å’Œæ¢è¡Œéƒ½æ²¡æœ‰ï¼Œè¿™æ ·å®é™…ä¸Šç”¨ä¸åˆ°å¤ªå¤šè¯­æ³•ã€‚

æ­£åˆ™æè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ã€‚åˆ—ä¸€ä¸‹æˆ‘ç”¨åˆ°çš„è¯­æ³•ï¼š

| å­—ç¬¦   | å«ä¹‰                         |
| ------ | ---------------------------- |
| \      | è½¬ä¹‰                         |
| .      | åŒ¹é…ä¸€ä¸ªéæ¢è¡Œå­—ç¬¦           |
| {n, m} | åŒ¹é…å‰ä¸€ä¸ªå­è¡¨è¾¾å¼nåˆ°mæ¬¡     |
| {n, }  | åŒ¹é…å‰ä¸€ä¸ªå­è¡¨è¾¾å¼è‡³å°‘næ¬¡    |
| *      | ç­‰ä»·äº{0,}                   |
| ^      | åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®     |
| $      | åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®     |
| (str)  | åŒ¹é…strï¼Œä¸”strä¸ºä¸€ä¸ªå­è¡¨è¾¾å¼ |
| [a-z]  | åŒ¹é…'a'-'z'çš„ä¸€ä¸ªå­—æ¯        |
| [0,9]  | åŒ¹é…'0'-'9'çš„ä¸€ä¸ªæ•°å­—        |

ä¸€ä¸ªæµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼çš„ç½‘ç«™ï¼šhttp://c.runoob.com/front-end/854

jsä¸­çš„æ­£åˆ™è¡¨è¾¾å¼è¦å†™åœ¨`/       /` ä¸­ï¼Œä¾‹å¦‚ï¼š

```javascript
url_reg = /\/\/www\.sohu\.com\/a\/.*/
```

å¯ä»¥åŒ¹é…

```
//www.sohu.com/a/391299036_114988?spm=smpc.news-home.top-news2.1.1587894845483yLbRjQ5

//www.sohu.com/a/391306114_115362?spm=smpc.news-home.top-news3.2.1587894845483yLbRjQ5

//www.sohu.com/a/391335217_161795?spm=smpc.news-home.top-news3.4.1587894845483yLbRjQ5
```



## express æ¡†æ¶

è¯´å¥½å°½é‡ä¸ä½¿ç”¨ä»»ä½•æ¡†æ¶ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä¸å¤ªä¼šæ€ä¹ˆå†™htmlä»£ç ã€‚htmlè¿æ¥æ•°æ®åº“å°±ä¸ä¼šäº†ï¼Œè¿˜æ˜¯è¦æŠ„è€å¸ˆä»£ç -_-||ã€‚

`express -e search_site` ç”Ÿæˆä¸€ä¸ªsearch_siteæ–‡ä»¶å¤¹ï¼Œå°†[mysql.js](https://github.com/ya-hong/crawler/blob/master/mysql.js)æ‹·è´è¿›æ–‡ä»¶å¤¹ï¼Œå†ä¿®æ”¹[`search_site/routes/index.js`](https://github.com/ya-hong/crawler/blob/master/search_site/routes/index.js) ,æŠŠ[search.html](https://github.com/ya-hong/crawler/blob/master/search_site/public/search.html)æ‹·è´è¿›publicæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å°±æŠ„å®Œäº†ä»£ç ã€‚

ç”¨nodeè¿è¡Œ`search_site/bin/www`å°±å¯ä»¥è®¿é—®`localhost:3000/search.html`æ¥æœç´¢äº†ã€‚



# ä»£ç å®ç°

## æœ€åˆçš„ä»£ç 

https://github.com/ya-hong/crawler/blob/master/del/baidunews.js

å› ä¸ºè¢«å¼‚æ­¥ææ‡µäº†ï¼Œæˆ‘è¿™é‡Œçš„callbackå®Œå…¨æ˜¯ä¹±å†™çš„ã€‚

åŸºæœ¬å°±æ˜¯ç®€å•çš„ç”¨requestè·å–htmlï¼Œå†ç”¨cheerioæŸ¥æ‰¾æ ‡é¢˜ã€é“¾æ¥å’Œæ­£æ–‡ï¼Œç„¶åå†™å…¥æ–‡ä»¶ã€‚

## ç¨å¾®æ”¹è¿›ä¸€ç‚¹

https://github.com/ya-hong/crawler/blob/master/del/xinglang.js

è¿™æ¬¡å¤šæ£€ç´¢äº†å‡ ä¸ªå…³é”®è¯ã€‚ä½†æ˜¯ç”±äºæˆ‘ä¸ä¼šæœç´¢ï¼Œåé¢å°±ä¸æƒ³æ”¹è¿›äº†ã€‚

## è€å¸ˆçš„ä»£ç 

https://github.com/ya-hong/crawler/tree/master/teachersCode

åé¢çš„åŸºæœ¬å°±åœ¨è€å¸ˆçš„æ¨¡æ¿ä¸Šæ”¹åŠ¨äº†ã€‚

## æ¯”è¾ƒæˆç†Ÿçš„ä»£ç 

åšäº†ä¸€äº›å¾®å°çš„å·¥ä½œã€‚

### é“¾æ¥çš„è·å–

è€å¸ˆç»™å‡ºçš„ä»£ç åŸºæœ¬å°±æ˜¯å¦‚æœèƒ½ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°ä¸œè¥¿ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸ªé“¾æ¥ç®—ä½œåˆç”¨çš„é“¾æ¥

```javascript
var href = "";
href = $(e).attr("href");
if (href == undefined) return;
if (href.toLowerCase().indexOf('http://') >= 0) myURL = href; //http://å¼€å¤´çš„
else if (href.startsWith('//')) myURL = 'http:' + href; ////å¼€å¤´çš„
else myURL = seedURL.substr(0, seedURL.lastIndexOf('/') + 1) + href; //å…¶ä»–
```

æˆ‘åœ¨å†™çˆ¬è™«çš„æ—¶å€™å‘ç°æœ‰æ—¶å€™hrefé‡Œä¼šæœ‰ä¸¤ä¸ªé“¾æ¥è¿åœ¨ä¸€èµ·çš„æƒ…å†µã€‚ æ¯”å¦‚`https://news.sina.com.cn/https://news.sina.com.cn/c/2020-04-26/doc-iirczymi8398853.shtml`ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆè§£å†³ã€‚

æ‰€ä»¥æˆ‘å°±ç›´æ¥ä»`//`åŒ¹é…åˆ°äº†ç»“å°¾ï¼š

```javascript
var href = "";
href = $(e).attr("href");
if (href == undefined) return;
if (!format.url_reg.test(href)) return;
myURL = "http:"+format.url_reg.exec(href)[0];
```

å…¶ä¸­

```javascript
format.url_reg=/\/\/news.sina.com.cn\/[a-z]\/.*\.shtml/
```

è¿™æ ·æ—¢è§£å†³äº†é“¾æ¥ç²˜åœ¨ä¸€èµ·çš„é—®é¢˜ï¼Œåˆä¸éœ€è¦åˆ¤æ–­è¿™ä¸ªé“¾æ¥åˆ°åº•æ˜¯httpå¼€å¤´ã€httpså¼€å¤´è¿˜æ˜¯//å¼€å¤´äº†ã€‚

### ç”¨è¡¨æ ¼æ˜¾ç¤ºæœç´¢ç»“æœ

å¥½åƒæœ‰è¦æ±‚ç”¨è¡¨æ ¼æ˜¾ç¤ºæœç´¢ç»“æœã€‚è™½ç„¶è€å¸ˆçš„ä»£ç å·²ç»ç”¨è¡¨æ ¼æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯æ²¡æœ‰æ¡†çœ‹ç€éš¾å—ã€‚

åœ¨`search/public/search.html`é‡Œçš„`<table>`æ ‡ç­¾åŠ ä¸€ä¸ª`<border>`å±æ€§å°±å¥½äº†ã€‚

```javascript
<table width="100%" id="record2" border="1"></table>
```



ç„¶åå°±å‘ç°äº†åŸæ¥ä»£ç çš„ä¸€ä¸ªå°é”™è¯¯ï¼š

![image-20200426204721985](/images/2020-4-26-ç¬¬ä¸€æ¬¡å®éªŒé¡¹ç›®-image-20200426204721985.png)

åé¢å…¨éƒ½å¤šäº†ä¸€ä¸ªå•å…ƒæ ¼

```html
for (let list of data) {
	let table = '<tr class="cardLayout"><td>';
	Object.values(list).forEach(element => {
		table += (element + '</td><td>');
	});
	$("#record2").append(table + '</td></tr>');
}
```

ä¿®æ”¹äº†ä¸€ä¸‹

```html
for (let list of data) {
	let table = '<tr class="cardLayout">';
	Object.values(list).forEach(element => {
		table += ('<td>' + element + '</td>');
	});
	$("#record2").append(table + '</tr>');
}
```

ä½†æ˜¯è¿˜çˆ¬äº†å¾ˆå¤šæ•°æ®éƒ½æ²¡æœ‰ç”¨ä¸Šï¼Œå¿ƒé‡Œæ„Ÿè§‰ä¸çˆ½ã€‚

äºæ˜¯æˆ‘æŠŠè¡¨å¤´æ”¹ç§°äº†urlï¼Œtitle, keywords, descriptionã€‚ è™½ç„¶ç”¨åˆ°çš„æ•°æ®å®é™…ä¸Šå˜å°‘äº†ï¼Œä½†æ˜¯æ„Ÿè§‰åˆç†äº†ä¸€äº›ã€‚

ç„¶åroutesä¹Ÿè¦åŒæ­¥çš„ä¿®æ”¹ã€‚è¯¥ä¸ºè¯¢é—®ä¸è¡¨å¤´ç›¸å…³çš„å››ä¸ªéƒ¨åˆ†ï¼š

```javascript
router.get('/process_get', function(request, response) {
    //sqlå­—ç¬¦ä¸²å’Œå‚æ•°
    var fetchSql = "select url,title,keywords,description " +
        "from fetches where title like '%" + request.query.title + "%'";
    mysql.query(fetchSql, function(err, result, fields) {
        response.writeHead(200, {
            "Content-Type": "application/json"
        });
        response.write(JSON.stringify(result));
        response.end();
    });
});
```

æ„Ÿè§‰åªä»æ ‡é¢˜æœç´¢ç»“æœå¤ªå°‘äº†ï¼Œæˆ‘å°±åŒæ—¶ä»æ ‡é¢˜å’Œå†…å®¹æœç´¢äº†ï¼š

```javascript
router.get('/process_get', function(request, response) {
    //sqlå­—ç¬¦ä¸²å’Œå‚æ•°
    var fetchSql = "select url,title,keywords,description " +
        "from fetches where title like '%" + request.query.title + "%' or content like '%" + request.query.title + "%'";
    mysql.query(fetchSql, function(err, result, fields) {
        response.writeHead(200, {
            "Content-Type": "application/json"
        });
        response.write(JSON.stringify(result));
        response.end();
    });
});
```



æœ€åæˆ‘æŠŠcssæ”¹ç§°äº†è‡ªå·±è·Ÿåšå®¢çš„ä¸€æ ·çš„[css](https://github.com/ya-hong/crawler/tree/master/search_site/public/css)ã€‚

```html
<header>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/clean-blog.min.css">
</header>
```

ä¸è¿‡åªæœ‰å­—ä½“å’Œå¤åˆ¶çš„é¢œè‰²æœ‰æ¯”è¾ƒæ˜æ˜¾çš„å˜åŒ–ã€‚

### ä»£ç çš„å°è£…

è¿™ä¸ªå…¶å®ä¸€å¼€å§‹å°±è¯¥åšäº†ã€‚æˆ‘è°ƒè¯•å®Œç¬¬ä¸€ä¸ªç½‘ç«™çš„ä»£ç åï¼ŒæŠŠå®ƒå¤åˆ¶äº†ä¸€éæ¥å†™ç¬¬äºŒä¸ªç½‘ç«™çš„ä»£ç ã€‚ç­‰æˆ‘å‘ç°ä»£ç æœ‰é—®é¢˜çš„æ—¶å€™å°±å·²ç»è¦æ”¹ä¸¤ä»½ä»£ç äº†ï¼Œç¬é—´è§‰å¾—è‡ªå·±æ˜¯ntã€‚

è¿˜å¥½é—®é¢˜å‘ç°çš„æ—©ï¼Œä¸ç„¶å°±è¦è°ƒä¸‰å››ä»½äº†ã€‚

ç”±äºç”¨äº†`eval()`æ‰€ä»¥è¿˜æ˜¯å¾ˆå®¹æ˜“æŠ½å‡ºä¸åŒç½‘ç«™çˆ¬è™«çš„ç›¸åŒä»£ç çš„ã€‚

åŸæ¥çš„ä»£ç ï¼šhttps://github.com/ya-hong/crawler/blob/master/teachersCode/crawler2.js

æ˜¾ç„¶`request`,`seedget`,`newsGet` è¿™ä¸‰ä¸ªå‡½æ•°å¯¹æ¯ä¸ªç½‘ç«™éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¯ä»¥å†™ä¸€ä¸ª[crawls.js](https://github.com/ya-hong/crawler/blob/master/crawler.js)æŠŠä»–ä»¬å†™åˆ°ä¸€èµ·ã€‚

ç„¶åæ¯ä»½çˆ¬è™«ä»£ç éƒ½æŠŠsource_name, title_format, url_reg è¿™äº›å˜é‡æ‰“åŒ…ä¼ é€’ç»™crawls.jsã€‚è¿™æ ·æ¯ä¸ªçˆ¬è™«ä»£ç éƒ½å¾ˆçŸ­ï¼Œè€Œä¸”crawls.jsæ¯æ¬¡è¦ä¿®æ”¹çš„æ—¶å€™ä¹Ÿä¸éœ€è¦åœ¨å¤šä¸ªä»£ç é‡Œä¿®æ”¹äº†ã€‚

```javascript
var crawler = require('./crawler');
var format = {
    source_name : "ä¸­å›½æ–°é—»ç½‘",
    myEncoding : "utf-8",
    seedURL : 'http://www.chinanews.com/',
    seedURL_format : "$('a')",
    keywords_format : " $('meta[name=\"keywords\"]').eq(0).attr(\"content\")",
    title_format : "$('title').text()",
    date_format : "$('#pubtime_baidu').text()",
    author_format : "$('#editor_baidu').text()",
    content_format : "$('.left_zw').text()",
    desc_format : " $('meta[name=\"description\"]').eq(0).attr(\"content\")",
    source_format : "$('#source_baidu').text()",
    url_reg : /^\/\/www\.chinanews\.com\/.*\/(\d{4})\/(\d{2})-(\d{2})\/(\d{7}).shtml$/,
    regExp : /((\d{4}|\d{2})(\-|\/|\.)\d{1,2}\3\d{1,2})|(\d{4}å¹´\d{1,2}æœˆ\d{1,2}æ—¥)/
};
crawler.seedget(format);
```



### ä¸€äº›ç»†èŠ‚

+   ä¸€äº›ç‰¹åˆ¤

    ä¸ç®¡æ€ä¹ˆåˆ¤æ–­ï¼Œå…‰å‡­urlè¿˜æ˜¯ä¸èƒ½ç¡®å®šè¿™ä¸ªé¡µé¢ä¸€å®šæ˜¯æ–°é—»é¡µé¢ã€‚è€Œä¸”å³ä½¿æ˜¯æ–°é—»é¡µé¢ä¹Ÿæœ‰å¯èƒ½å‡ºç°ä¸ä¸€æ ·çš„æ ¼å¼ã€‚æ‰€ä»¥å¯èƒ½ä¼šè¯»ä¸åˆ°dateï¼Œå¦‚æœè¯»ä¸åˆ°dateç›´æ¥è¿›è¡Œåç»­æ“ä½œå°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥å¿…é¡»åˆ¤æ–­å®ƒæœ‰æ²¡æœ‰è¯»å–åˆ°ã€‚

+   è¾“å‡ºé¡ºåº

    jsçš„è¾“å‡ºå¯èƒ½ä¸ä¼šæŒ‰è‡ªå·±æƒ³è±¡çš„æ¥ï¼Œä¹Ÿæ˜¯å¼‚æ­¥ç‰¹æ€§çš„å¼Šç«¯å§ã€‚å³ä½¿æˆ‘å·²ç»çŸ¥é“äº†jsæ˜¯å¼‚æ­¥çš„ï¼Œçœ‹åˆ°consoleçš„è¾“å‡ºè¿˜æ˜¯æ‡µäº†ã€‚æ„Ÿè§‰è¿™ä¸ªç‰¹æ€§ç»™debugå¸¦æ¥æå¤§å›°éš¾ã€‚

+   ä¹‹å‰çš„ä»£ç å¹¶ä¸èƒ½ä¿è¯ä¸å†™å…¥é‡å¤çš„url

    å¦‚æœåœ¨ç§å­é¡µé¢ä¸Šè¯»å–äº†åŒä¸€ä¸ªurlä¸¤æ¬¡ï¼Œå°±å¯èƒ½ä¼šå†™å…¥é‡å¤çš„urlã€‚ç”±äºå¼‚æ­¥ç‰¹æ€§ï¼Œjså…ˆå¯¹æ‰€æœ‰urlåˆ¤æ–­æ•°æ®åº“ä¸­æ˜¯å¦æœ‰ç›¸åŒurlï¼Œç„¶åå†å°†æ‰€æœ‰urlå†™å…¥ï¼Œå¯¼è‡´äº†é‡å¤ã€‚è¿™å…¶å®é—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯ä¸€å¼€å§‹çœ‹åˆ°æˆ‘è¿˜ä»¥ä¸ºmysqlå‡ºé—®é¢˜äº†ã€‚

# æˆæœå±•ç¤º

![image-20200426212813943](/images/2020-4-26-ç¬¬ä¸€æ¬¡å®éªŒé¡¹ç›®-image-20200426212813943.png)

å…¶å®è¿˜æ˜¯å¾ˆç®€é™‹ï¼Œåªæœ‰å¤åˆ¶é¢œè‰²ç¨å¾®æ¼‚äº®äº†ä¸€ç‚¹ã€‚

ä¸å¤Ÿä¿®æ”¹äº†ä¸€ä¸‹æœç´¢ï¼Œèµ·ç ç»“æœå˜å¤šäº†ã€‚

# å­¦ä¹ ä½“ä¼š

ï¼ˆæ–½å·¥ä¸­ï¼‰



